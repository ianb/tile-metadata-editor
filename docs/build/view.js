/* eslint-disable jsx-a11y/no-access-key */

/* eslint-disable jsx-a11y/no-static-element-interactions */

/* eslint-disable jsx-a11y/click-events-have-key-events */

/* eslint-disable jsx-a11y/no-noninteractive-element-interactions */
// Not compatible with JSX:

/* eslint-disable no-unused-vars */

/* globals React */
export class View extends React.Component {
  render() {
    return /*#__PURE__*/React.createElement("div", {
      style: {
        height: "100vh",
        width: "100vw",
        display: "grid",
        gridTemplateColumns: "1fr 2fr",
        gridTemplateRows: "1fr 1fr"
      }
    }, /*#__PURE__*/React.createElement("div", {
      style: {
        gridRowStart: "1",
        gridRowEnd: "span 2",
        overflow: "scroll"
      }
    }, /*#__PURE__*/React.createElement(Controls, {
      controller: this.props.controller
    }), /*#__PURE__*/React.createElement("div", {
      style: {
        overflow: "scroll"
      }
    }, /*#__PURE__*/React.createElement(TileList, {
      clickTileStatus: this.props.clickTileStatus,
      controller: this.props.controller,
      tileset: this.props.tileset
    }))), /*#__PURE__*/React.createElement("div", {
      style: {
        gridColumnStart: "2",
        gridRowStart: "1"
      }
    }, /*#__PURE__*/React.createElement(TileEditor, {
      tile: this.props.editTile1,
      tileset: this.props.tileset,
      controller: this.props.controller,
      primary: true
    })), /*#__PURE__*/React.createElement("div", {
      style: {
        gridColumnStart: "2",
        gridRowStart: "2"
      }
    }, /*#__PURE__*/React.createElement(TileEditor, {
      tile: this.props.editTile2,
      tileset: this.props.tileset,
      controller: this.props.controller,
      primary: false
    })));
  }

}

class Controls extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      saving: false
    };
  }

  render() {
    return /*#__PURE__*/React.createElement("fieldset", null, /*#__PURE__*/React.createElement("legend", null, "Controls"), /*#__PURE__*/React.createElement("button", {
      type: "button",
      onClick: this.onSave.bind(this)
    }, this.state.saving ? "Saved!" : "Save"), /*#__PURE__*/React.createElement("label", null, "Import:", /*#__PURE__*/React.createElement("input", {
      type: "file",
      ref: this.fileRef,
      onInput: this.onInput.bind(this),
      multiple: "1"
    })));
  }

  onSave() {
    this.props.controller.save();
    this.setState({
      saving: true
    });
    setTimeout(() => {
      this.setState({
        saving: false
      });
    }, 2000);
  }

  onInput(event) {
    this.props.controller.addFiles(event.target.files);
  }

}

class TileList extends React.Component {
  render() {
    const result = [];
    const grids = this.props.tileset.tileGrids();

    for (const grid of grids) {
      result.push( /*#__PURE__*/React.createElement(TileGrid, {
        sourceFilename: grid.sourceFilename,
        grid: grid.grid,
        controller: this.props.controller,
        key: grid.sourceFilename
      }));
    }

    return /*#__PURE__*/React.createElement("div", null, this.props.clickTileStatus ? /*#__PURE__*/React.createElement("div", {
      onClick: this.onClickStatus.bind(this)
    }, "On click: ", this.props.clickTileStatus) : null, /*#__PURE__*/React.createElement(SpecialTiles, {
      controller: this.props.controller,
      tileset: this.props.tileset
    }), result);
  }

  onClickStatus() {
    this.props.controller.editTile(null);
  }

}

class SpecialTiles extends React.Component {
  render() {
    const examples = [];

    for (const e of this.props.tileset.examples()) {
      examples.push( /*#__PURE__*/React.createElement("li", {
        onClick: () => this.props.controller.editGroup(e.group, e.tile)
      }, /*#__PURE__*/React.createElement("img", {
        src: e.tile.imageUrl,
        alt: ""
      }), "Group ", e.group));
    }

    return /*#__PURE__*/React.createElement("ul", {
      className: "special-tiles"
    }, /*#__PURE__*/React.createElement("li", {
      onClick: () => this.props.controller.editEmptyTile()
    }, /*#__PURE__*/React.createElement("img", {
      src: "/images/delete.png",
      alt: "delete"
    }), "Delete / blank"), examples);
  }

}

class TileGrid extends React.Component {
  render() {
    const tableRows = [];

    for (let y = 0; y < this.props.grid.length; y++) {
      const row = [];

      for (let x = 0; x < this.props.grid[y].length; x++) {
        const tile = this.props.grid[y][x];

        if (!tile) {
          row.push( /*#__PURE__*/React.createElement("td", {
            key: x
          }));
        } else {
          row.push( /*#__PURE__*/React.createElement("td", {
            key: x
          }, /*#__PURE__*/React.createElement(Tile, {
            tile: tile,
            controller: this.props.controller
          })));
        }
      }

      tableRows.push( /*#__PURE__*/React.createElement("tr", {
        key: y
      }, row));
    }

    return /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", null, this.props.sourceFilename, " ", /*#__PURE__*/React.createElement("button", {
      type: "button",
      onClick: this.deleteSource.bind(this)
    }, "\xD7")), /*#__PURE__*/React.createElement("table", {
      className: "tiles"
    }, tableRows));
  }

  deleteSource() {
    if (!window.confirm("Delete this entire set of tiles?")) {
      return;
    }

    this.props.controller.deleteSource(this.props.sourceFilename);
  }

}

class Tile extends React.Component {
  render() {
    return /*#__PURE__*/React.createElement(TileImage, {
      tile: this.props.tile,
      onClick: this.onClick.bind(this)
    });
  }

  onClick() {
    this.props.controller.editTile(this.props.tile);
  }

}

class TileImage extends React.Component {
  render() {
    const anim = this.props.tile.animateUrls;
    const main = this.props.tile.imageUrl;

    if (!anim) {
      return /*#__PURE__*/React.createElement("img", {
        className: this.props.className,
        src: main,
        alt: `Tile ${this.props.tile.id}`,
        onClick: this.props.onClick
      });
    }

    const images = [main].concat(anim);
    return /*#__PURE__*/React.createElement("div", {
      className: `anim-tiles ${this.props.className || ""}`,
      onClick: this.props.onClick
    }, images.map((url, index) => {
      return /*#__PURE__*/React.createElement("img", {
        style: this.props.style,
        src: url,
        key: index,
        alt: `Tile ${index + 1} ${this.props.tile.id}`,
        className: `image-${index + 1}-of-${images.length}`
      });
    }));
  }

}

class TileEditor extends React.Component {
  render() {
    const tile = this.props.tile;
    const tileset = this.props.tileset;

    if (!tile) {
      return /*#__PURE__*/React.createElement("div", null, "Click to edit a tile");
    }

    function radioClass(objectType) {
      if (objectType === null && !tile.objectType || tile.objectType === objectType) {
        return "selected";
      }

      return null;
    }

    return /*#__PURE__*/React.createElement("fieldset", null, /*#__PURE__*/React.createElement("legend", null, "Tile editor ", tile.id), /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement(TileImage, {
      tile: tile,
      className: "x2"
    }), /*#__PURE__*/React.createElement("button", {
      type: "button",
      onClick: this.addAnimation.bind(this)
    }, "+anim"), /*#__PURE__*/React.createElement("label", null, "Title:", /*#__PURE__*/React.createElement("input", {
      type: "text",
      defaultValue: tile.title,
      onKeyUp: this.editTitle.bind(this)
    })), /*#__PURE__*/React.createElement("label", null, "Group:", /*#__PURE__*/React.createElement("input", {
      type: "text",
      value: tile.specificGroup || "",
      onChange: this.editGroup.bind(this)
    })), /*#__PURE__*/React.createElement("label", null, "Example:", /*#__PURE__*/React.createElement("input", {
      type: "checkbox",
      checked: tile.isExample,
      onChange: this.editExample.bind(this)
    })), /*#__PURE__*/React.createElement("button", {
      type: "button",
      onClick: this.deleteTile.bind(this),
      accessKey: this.props.primary ? "d" : null
    }, "Delete"), /*#__PURE__*/React.createElement("div", {
      className: "radios"
    }, "Type:", /*#__PURE__*/React.createElement("label", {
      className: radioClass(null)
    }, /*#__PURE__*/React.createElement("input", {
      type: "radio",
      name: `objectType-${tile.id}`,
      value: "none",
      checked: !tile.objectType,
      onChange: this.onTypeChange.bind(this)
    }), "None"), /*#__PURE__*/React.createElement("label", {
      className: radioClass("ground")
    }, /*#__PURE__*/React.createElement("input", {
      type: "radio",
      name: `objectType-${tile.id}`,
      value: "ground",
      checked: tile.objectType === "ground",
      onChange: this.onTypeChange.bind(this)
    }), "Ground"), /*#__PURE__*/React.createElement("label", {
      className: radioClass("decor")
    }, /*#__PURE__*/React.createElement("input", {
      type: "radio",
      name: `objectType-${tile.id}`,
      value: "decor",
      checked: tile.objectType === "decor",
      onChange: this.onTypeChange.bind(this)
    }), "Decor"), /*#__PURE__*/React.createElement("label", {
      className: radioClass("object")
    }, /*#__PURE__*/React.createElement("input", {
      type: "radio",
      name: `objectType-${tile.id}`,
      value: "object",
      checked: tile.objectType === "object",
      onChange: this.onTypeChange.bind(this)
    }), "Object"))), /*#__PURE__*/React.createElement("hr", null), /*#__PURE__*/React.createElement("div", null, [0, 1, 2, 3].map(i => /*#__PURE__*/React.createElement(TileDirections, {
      tile: tile,
      tileset: tileset,
      controller: this.props.controller,
      count: i,
      key: i
    }))));
  }

  editTitle(event) {
    this.props.tile.title = event.target.value;
  }

  editGroup(event) {
    this.props.tile.specificGroup = event.target.value;
    this.props.controller.render();
  }

  editExample(event) {
    this.props.tile.isExample = event.target.checked;
    this.props.controller.render();
  }

  deleteTile() {
    if (!window.confirm("Really delete?")) {
      return;
    }

    this.props.tile.tileset.deleteTile(this.props.tile);
    this.props.controller.render();
  }

  addAnimation() {
    this.props.controller.addAnimation(this.props.tile);
  }

  onTypeChange(event) {
    let value = event.target.value;

    if (value === "none") {
      value = null;
    }

    this.props.tile.objectType = value;
    this.props.controller.render();
  }

}

class TileDirections extends React.Component {
  render() {
    const tile = this.props.tile;
    const count = this.props.count;
    const left = tile.getDirection("left", count);
    const right = tile.getDirection("right", count);
    const top = tile.getDirection("top", count);
    const bottom = tile.getDirection("bottom", count);

    function tileImg(tile) {
      return /*#__PURE__*/React.createElement("img", {
        src: tile.imageUrl,
        className: tile.groupId ? "group-tile" : null,
        alt: ""
      });
    }

    return /*#__PURE__*/React.createElement("div", {
      style: {
        display: "inline-grid",
        gridTemplateColumns: "32px 32px 32px",
        gridTemplateRows: "32px 32px 32px"
      }
    }, /*#__PURE__*/React.createElement("div", {
      style: {
        gridColumnStart: 2,
        gridRowStart: 1
      },
      className: "tile-dir",
      onClick: this.editDirection.bind(this, "top")
    }, top ? tileImg(top) : /*#__PURE__*/React.createElement("img", {
      src: "images/dir-up.png",
      alt: "add up tile"
    })), /*#__PURE__*/React.createElement("div", {
      style: {
        gridColumnStart: 1,
        gridRowStart: 2
      },
      className: "tile-dir",
      onClick: this.editDirection.bind(this, "left")
    }, left ? tileImg(left) : /*#__PURE__*/React.createElement("img", {
      src: "images/dir-left.png",
      alt: "add left tile"
    })), /*#__PURE__*/React.createElement("div", {
      style: {
        gridColumnStart: 2,
        gridGrowStart: 2
      }
    }, /*#__PURE__*/React.createElement("img", {
      src: tile.imageUrl,
      alt: "Main tile"
    })), /*#__PURE__*/React.createElement("div", {
      style: {
        gridColumnStart: 3,
        gridRowStart: 2
      },
      className: "tile-dir",
      onClick: this.editDirection.bind(this, "right")
    }, right ? tileImg(right) : /*#__PURE__*/React.createElement("img", {
      src: "images/dir-right.png",
      alt: "add right tile"
    })), /*#__PURE__*/React.createElement("div", {
      style: {
        gridColumnStart: 2,
        gridRowStart: 3
      },
      className: "tile-dir",
      onClick: this.editDirection.bind(this, "bottom")
    }, bottom ? tileImg(bottom) : /*#__PURE__*/React.createElement("img", {
      src: "images/dir-down.png",
      alt: "add down tile"
    })));
  }

  editDirection(direction) {
    this.props.controller.editDirection(this.props.tile, direction, this.props.count);
  }

}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3ZpZXcuanN4Il0sIm5hbWVzIjpbIlZpZXciLCJSZWFjdCIsIkNvbXBvbmVudCIsInJlbmRlciIsImhlaWdodCIsIndpZHRoIiwiZGlzcGxheSIsImdyaWRUZW1wbGF0ZUNvbHVtbnMiLCJncmlkVGVtcGxhdGVSb3dzIiwiZ3JpZFJvd1N0YXJ0IiwiZ3JpZFJvd0VuZCIsIm92ZXJmbG93IiwicHJvcHMiLCJjb250cm9sbGVyIiwiY2xpY2tUaWxlU3RhdHVzIiwidGlsZXNldCIsImdyaWRDb2x1bW5TdGFydCIsImVkaXRUaWxlMSIsImVkaXRUaWxlMiIsIkNvbnRyb2xzIiwiY29uc3RydWN0b3IiLCJzdGF0ZSIsInNhdmluZyIsIm9uU2F2ZSIsImJpbmQiLCJmaWxlUmVmIiwib25JbnB1dCIsInNhdmUiLCJzZXRTdGF0ZSIsInNldFRpbWVvdXQiLCJldmVudCIsImFkZEZpbGVzIiwidGFyZ2V0IiwiZmlsZXMiLCJUaWxlTGlzdCIsInJlc3VsdCIsImdyaWRzIiwidGlsZUdyaWRzIiwiZ3JpZCIsInB1c2giLCJzb3VyY2VGaWxlbmFtZSIsIm9uQ2xpY2tTdGF0dXMiLCJlZGl0VGlsZSIsIlNwZWNpYWxUaWxlcyIsImV4YW1wbGVzIiwiZSIsImVkaXRHcm91cCIsImdyb3VwIiwidGlsZSIsImltYWdlVXJsIiwiZWRpdEVtcHR5VGlsZSIsIlRpbGVHcmlkIiwidGFibGVSb3dzIiwieSIsImxlbmd0aCIsInJvdyIsIngiLCJkZWxldGVTb3VyY2UiLCJ3aW5kb3ciLCJjb25maXJtIiwiVGlsZSIsIm9uQ2xpY2siLCJUaWxlSW1hZ2UiLCJhbmltIiwiYW5pbWF0ZVVybHMiLCJtYWluIiwiY2xhc3NOYW1lIiwiaWQiLCJpbWFnZXMiLCJjb25jYXQiLCJtYXAiLCJ1cmwiLCJpbmRleCIsInN0eWxlIiwiVGlsZUVkaXRvciIsInJhZGlvQ2xhc3MiLCJvYmplY3RUeXBlIiwiYWRkQW5pbWF0aW9uIiwidGl0bGUiLCJlZGl0VGl0bGUiLCJzcGVjaWZpY0dyb3VwIiwiaXNFeGFtcGxlIiwiZWRpdEV4YW1wbGUiLCJkZWxldGVUaWxlIiwicHJpbWFyeSIsIm9uVHlwZUNoYW5nZSIsImkiLCJ2YWx1ZSIsImNoZWNrZWQiLCJUaWxlRGlyZWN0aW9ucyIsImNvdW50IiwibGVmdCIsImdldERpcmVjdGlvbiIsInJpZ2h0IiwidG9wIiwiYm90dG9tIiwidGlsZUltZyIsImdyb3VwSWQiLCJlZGl0RGlyZWN0aW9uIiwiZ3JpZEdyb3dTdGFydCIsImRpcmVjdGlvbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7QUFDQTs7QUFDQTs7QUFDQTtBQUVBLE9BQU8sTUFBTUEsSUFBTixTQUFtQkMsS0FBSyxDQUFDQyxTQUF6QixDQUFtQztBQUN4Q0MsRUFBQUEsTUFBTSxHQUFHO0FBQ1Asd0JBQ0U7QUFDRSxNQUFBLEtBQUssRUFBRTtBQUNMQyxRQUFBQSxNQUFNLEVBQUUsT0FESDtBQUVMQyxRQUFBQSxLQUFLLEVBQUUsT0FGRjtBQUdMQyxRQUFBQSxPQUFPLEVBQUUsTUFISjtBQUlMQyxRQUFBQSxtQkFBbUIsRUFBRSxTQUpoQjtBQUtMQyxRQUFBQSxnQkFBZ0IsRUFBRTtBQUxiO0FBRFQsb0JBU0U7QUFDRSxNQUFBLEtBQUssRUFBRTtBQUNMQyxRQUFBQSxZQUFZLEVBQUUsR0FEVDtBQUVMQyxRQUFBQSxVQUFVLEVBQUUsUUFGUDtBQUdMQyxRQUFBQSxRQUFRLEVBQUU7QUFITDtBQURULG9CQU9FLG9CQUFDLFFBQUQ7QUFBVSxNQUFBLFVBQVUsRUFBRSxLQUFLQyxLQUFMLENBQVdDO0FBQWpDLE1BUEYsZUFRRTtBQUFLLE1BQUEsS0FBSyxFQUFFO0FBQUVGLFFBQUFBLFFBQVEsRUFBRTtBQUFaO0FBQVosb0JBQ0Usb0JBQUMsUUFBRDtBQUNFLE1BQUEsZUFBZSxFQUFFLEtBQUtDLEtBQUwsQ0FBV0UsZUFEOUI7QUFFRSxNQUFBLFVBQVUsRUFBRSxLQUFLRixLQUFMLENBQVdDLFVBRnpCO0FBR0UsTUFBQSxPQUFPLEVBQUUsS0FBS0QsS0FBTCxDQUFXRztBQUh0QixNQURGLENBUkYsQ0FURixlQTBCRTtBQUNFLE1BQUEsS0FBSyxFQUFFO0FBQ0xDLFFBQUFBLGVBQWUsRUFBRSxHQURaO0FBRUxQLFFBQUFBLFlBQVksRUFBRTtBQUZUO0FBRFQsb0JBTUUsb0JBQUMsVUFBRDtBQUNFLE1BQUEsSUFBSSxFQUFFLEtBQUtHLEtBQUwsQ0FBV0ssU0FEbkI7QUFFRSxNQUFBLE9BQU8sRUFBRSxLQUFLTCxLQUFMLENBQVdHLE9BRnRCO0FBR0UsTUFBQSxVQUFVLEVBQUUsS0FBS0gsS0FBTCxDQUFXQyxVQUh6QjtBQUlFLE1BQUEsT0FBTyxFQUFFO0FBSlgsTUFORixDQTFCRixlQXdDRTtBQUNFLE1BQUEsS0FBSyxFQUFFO0FBQ0xHLFFBQUFBLGVBQWUsRUFBRSxHQURaO0FBRUxQLFFBQUFBLFlBQVksRUFBRTtBQUZUO0FBRFQsb0JBTUUsb0JBQUMsVUFBRDtBQUNFLE1BQUEsSUFBSSxFQUFFLEtBQUtHLEtBQUwsQ0FBV00sU0FEbkI7QUFFRSxNQUFBLE9BQU8sRUFBRSxLQUFLTixLQUFMLENBQVdHLE9BRnRCO0FBR0UsTUFBQSxVQUFVLEVBQUUsS0FBS0gsS0FBTCxDQUFXQyxVQUh6QjtBQUlFLE1BQUEsT0FBTyxFQUFFO0FBSlgsTUFORixDQXhDRixDQURGO0FBd0REOztBQTFEdUM7O0FBNkQxQyxNQUFNTSxRQUFOLFNBQXVCbEIsS0FBSyxDQUFDQyxTQUE3QixDQUF1QztBQUNyQ2tCLEVBQUFBLFdBQVcsQ0FBQ1IsS0FBRCxFQUFRO0FBQ2pCLFVBQU1BLEtBQU47QUFDQSxTQUFLUyxLQUFMLEdBQWE7QUFBRUMsTUFBQUEsTUFBTSxFQUFFO0FBQVYsS0FBYjtBQUNEOztBQUNEbkIsRUFBQUEsTUFBTSxHQUFHO0FBQ1Asd0JBQ0UsbURBQ0UsK0NBREYsZUFFRTtBQUFRLE1BQUEsSUFBSSxFQUFDLFFBQWI7QUFBc0IsTUFBQSxPQUFPLEVBQUUsS0FBS29CLE1BQUwsQ0FBWUMsSUFBWixDQUFpQixJQUFqQjtBQUEvQixPQUNHLEtBQUtILEtBQUwsQ0FBV0MsTUFBWCxHQUFvQixRQUFwQixHQUErQixNQURsQyxDQUZGLGVBS0UsMkRBRUU7QUFDRSxNQUFBLElBQUksRUFBQyxNQURQO0FBRUUsTUFBQSxHQUFHLEVBQUUsS0FBS0csT0FGWjtBQUdFLE1BQUEsT0FBTyxFQUFFLEtBQUtDLE9BQUwsQ0FBYUYsSUFBYixDQUFrQixJQUFsQixDQUhYO0FBSUUsTUFBQSxRQUFRLEVBQUM7QUFKWCxNQUZGLENBTEYsQ0FERjtBQWlCRDs7QUFFREQsRUFBQUEsTUFBTSxHQUFHO0FBQ1AsU0FBS1gsS0FBTCxDQUFXQyxVQUFYLENBQXNCYyxJQUF0QjtBQUNBLFNBQUtDLFFBQUwsQ0FBYztBQUFFTixNQUFBQSxNQUFNLEVBQUU7QUFBVixLQUFkO0FBQ0FPLElBQUFBLFVBQVUsQ0FBQyxNQUFNO0FBQ2YsV0FBS0QsUUFBTCxDQUFjO0FBQUVOLFFBQUFBLE1BQU0sRUFBRTtBQUFWLE9BQWQ7QUFDRCxLQUZTLEVBRVAsSUFGTyxDQUFWO0FBR0Q7O0FBRURJLEVBQUFBLE9BQU8sQ0FBQ0ksS0FBRCxFQUFRO0FBQ2IsU0FBS2xCLEtBQUwsQ0FBV0MsVUFBWCxDQUFzQmtCLFFBQXRCLENBQStCRCxLQUFLLENBQUNFLE1BQU4sQ0FBYUMsS0FBNUM7QUFDRDs7QUFuQ29DOztBQXNDdkMsTUFBTUMsUUFBTixTQUF1QmpDLEtBQUssQ0FBQ0MsU0FBN0IsQ0FBdUM7QUFDckNDLEVBQUFBLE1BQU0sR0FBRztBQUNQLFVBQU1nQyxNQUFNLEdBQUcsRUFBZjtBQUNBLFVBQU1DLEtBQUssR0FBRyxLQUFLeEIsS0FBTCxDQUFXRyxPQUFYLENBQW1Cc0IsU0FBbkIsRUFBZDs7QUFDQSxTQUFLLE1BQU1DLElBQVgsSUFBbUJGLEtBQW5CLEVBQTBCO0FBQ3hCRCxNQUFBQSxNQUFNLENBQUNJLElBQVAsZUFDRSxvQkFBQyxRQUFEO0FBQ0UsUUFBQSxjQUFjLEVBQUVELElBQUksQ0FBQ0UsY0FEdkI7QUFFRSxRQUFBLElBQUksRUFBRUYsSUFBSSxDQUFDQSxJQUZiO0FBR0UsUUFBQSxVQUFVLEVBQUUsS0FBSzFCLEtBQUwsQ0FBV0MsVUFIekI7QUFJRSxRQUFBLEdBQUcsRUFBRXlCLElBQUksQ0FBQ0U7QUFKWixRQURGO0FBUUQ7O0FBQ0Qsd0JBQ0UsaUNBQ0csS0FBSzVCLEtBQUwsQ0FBV0UsZUFBWCxnQkFDQztBQUFLLE1BQUEsT0FBTyxFQUFFLEtBQUsyQixhQUFMLENBQW1CakIsSUFBbkIsQ0FBd0IsSUFBeEI7QUFBZCxxQkFDYSxLQUFLWixLQUFMLENBQVdFLGVBRHhCLENBREQsR0FJRyxJQUxOLGVBTUUsb0JBQUMsWUFBRDtBQUNFLE1BQUEsVUFBVSxFQUFFLEtBQUtGLEtBQUwsQ0FBV0MsVUFEekI7QUFFRSxNQUFBLE9BQU8sRUFBRSxLQUFLRCxLQUFMLENBQVdHO0FBRnRCLE1BTkYsRUFVR29CLE1BVkgsQ0FERjtBQWNEOztBQUVETSxFQUFBQSxhQUFhLEdBQUc7QUFDZCxTQUFLN0IsS0FBTCxDQUFXQyxVQUFYLENBQXNCNkIsUUFBdEIsQ0FBK0IsSUFBL0I7QUFDRDs7QUFoQ29DOztBQW1DdkMsTUFBTUMsWUFBTixTQUEyQjFDLEtBQUssQ0FBQ0MsU0FBakMsQ0FBMkM7QUFDekNDLEVBQUFBLE1BQU0sR0FBRztBQUNQLFVBQU15QyxRQUFRLEdBQUcsRUFBakI7O0FBQ0EsU0FBSyxNQUFNQyxDQUFYLElBQWdCLEtBQUtqQyxLQUFMLENBQVdHLE9BQVgsQ0FBbUI2QixRQUFuQixFQUFoQixFQUErQztBQUM3Q0EsTUFBQUEsUUFBUSxDQUFDTCxJQUFULGVBQ0U7QUFBSSxRQUFBLE9BQU8sRUFBRSxNQUFNLEtBQUszQixLQUFMLENBQVdDLFVBQVgsQ0FBc0JpQyxTQUF0QixDQUFnQ0QsQ0FBQyxDQUFDRSxLQUFsQyxFQUF5Q0YsQ0FBQyxDQUFDRyxJQUEzQztBQUFuQixzQkFDRTtBQUFLLFFBQUEsR0FBRyxFQUFFSCxDQUFDLENBQUNHLElBQUYsQ0FBT0MsUUFBakI7QUFBMkIsUUFBQSxHQUFHLEVBQUM7QUFBL0IsUUFERixZQUVTSixDQUFDLENBQUNFLEtBRlgsQ0FERjtBQU1EOztBQUNELHdCQUNFO0FBQUksTUFBQSxTQUFTLEVBQUM7QUFBZCxvQkFDRTtBQUFJLE1BQUEsT0FBTyxFQUFFLE1BQU0sS0FBS25DLEtBQUwsQ0FBV0MsVUFBWCxDQUFzQnFDLGFBQXRCO0FBQW5CLG9CQUNFO0FBQUssTUFBQSxHQUFHLEVBQUMsb0JBQVQ7QUFBOEIsTUFBQSxHQUFHLEVBQUM7QUFBbEMsTUFERixtQkFERixFQUtHTixRQUxILENBREY7QUFTRDs7QUFwQndDOztBQXVCM0MsTUFBTU8sUUFBTixTQUF1QmxELEtBQUssQ0FBQ0MsU0FBN0IsQ0FBdUM7QUFDckNDLEVBQUFBLE1BQU0sR0FBRztBQUNQLFVBQU1pRCxTQUFTLEdBQUcsRUFBbEI7O0FBQ0EsU0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUt6QyxLQUFMLENBQVcwQixJQUFYLENBQWdCZ0IsTUFBcEMsRUFBNENELENBQUMsRUFBN0MsRUFBaUQ7QUFDL0MsWUFBTUUsR0FBRyxHQUFHLEVBQVo7O0FBQ0EsV0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUs1QyxLQUFMLENBQVcwQixJQUFYLENBQWdCZSxDQUFoQixFQUFtQkMsTUFBdkMsRUFBK0NFLENBQUMsRUFBaEQsRUFBb0Q7QUFDbEQsY0FBTVIsSUFBSSxHQUFHLEtBQUtwQyxLQUFMLENBQVcwQixJQUFYLENBQWdCZSxDQUFoQixFQUFtQkcsQ0FBbkIsQ0FBYjs7QUFDQSxZQUFJLENBQUNSLElBQUwsRUFBVztBQUNUTyxVQUFBQSxHQUFHLENBQUNoQixJQUFKLGVBQVM7QUFBSSxZQUFBLEdBQUcsRUFBRWlCO0FBQVQsWUFBVDtBQUNELFNBRkQsTUFFTztBQUNMRCxVQUFBQSxHQUFHLENBQUNoQixJQUFKLGVBQ0U7QUFBSSxZQUFBLEdBQUcsRUFBRWlCO0FBQVQsMEJBQ0Usb0JBQUMsSUFBRDtBQUFNLFlBQUEsSUFBSSxFQUFFUixJQUFaO0FBQWtCLFlBQUEsVUFBVSxFQUFFLEtBQUtwQyxLQUFMLENBQVdDO0FBQXpDLFlBREYsQ0FERjtBQUtEO0FBQ0Y7O0FBQ0R1QyxNQUFBQSxTQUFTLENBQUNiLElBQVYsZUFBZTtBQUFJLFFBQUEsR0FBRyxFQUFFYztBQUFULFNBQWFFLEdBQWIsQ0FBZjtBQUNEOztBQUNELHdCQUNFLDhDQUNFLGlDQUNHLEtBQUszQyxLQUFMLENBQVc0QixjQURkLEVBQzhCLEdBRDlCLGVBRUU7QUFBUSxNQUFBLElBQUksRUFBQyxRQUFiO0FBQXNCLE1BQUEsT0FBTyxFQUFFLEtBQUtpQixZQUFMLENBQWtCakMsSUFBbEIsQ0FBdUIsSUFBdkI7QUFBL0IsY0FGRixDQURGLGVBT0U7QUFBTyxNQUFBLFNBQVMsRUFBQztBQUFqQixPQUEwQjRCLFNBQTFCLENBUEYsQ0FERjtBQVdEOztBQUVESyxFQUFBQSxZQUFZLEdBQUc7QUFDYixRQUFJLENBQUNDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFlLGtDQUFmLENBQUwsRUFBeUQ7QUFDdkQ7QUFDRDs7QUFDRCxTQUFLL0MsS0FBTCxDQUFXQyxVQUFYLENBQXNCNEMsWUFBdEIsQ0FBbUMsS0FBSzdDLEtBQUwsQ0FBVzRCLGNBQTlDO0FBQ0Q7O0FBckNvQzs7QUF3Q3ZDLE1BQU1vQixJQUFOLFNBQW1CM0QsS0FBSyxDQUFDQyxTQUF6QixDQUFtQztBQUNqQ0MsRUFBQUEsTUFBTSxHQUFHO0FBQ1Asd0JBQ0Usb0JBQUMsU0FBRDtBQUFXLE1BQUEsSUFBSSxFQUFFLEtBQUtTLEtBQUwsQ0FBV29DLElBQTVCO0FBQWtDLE1BQUEsT0FBTyxFQUFFLEtBQUthLE9BQUwsQ0FBYXJDLElBQWIsQ0FBa0IsSUFBbEI7QUFBM0MsTUFERjtBQUdEOztBQUVEcUMsRUFBQUEsT0FBTyxHQUFHO0FBQ1IsU0FBS2pELEtBQUwsQ0FBV0MsVUFBWCxDQUFzQjZCLFFBQXRCLENBQStCLEtBQUs5QixLQUFMLENBQVdvQyxJQUExQztBQUNEOztBQVRnQzs7QUFZbkMsTUFBTWMsU0FBTixTQUF3QjdELEtBQUssQ0FBQ0MsU0FBOUIsQ0FBd0M7QUFDdENDLEVBQUFBLE1BQU0sR0FBRztBQUNQLFVBQU00RCxJQUFJLEdBQUcsS0FBS25ELEtBQUwsQ0FBV29DLElBQVgsQ0FBZ0JnQixXQUE3QjtBQUNBLFVBQU1DLElBQUksR0FBRyxLQUFLckQsS0FBTCxDQUFXb0MsSUFBWCxDQUFnQkMsUUFBN0I7O0FBQ0EsUUFBSSxDQUFDYyxJQUFMLEVBQVc7QUFDVCwwQkFDRTtBQUNFLFFBQUEsU0FBUyxFQUFFLEtBQUtuRCxLQUFMLENBQVdzRCxTQUR4QjtBQUVFLFFBQUEsR0FBRyxFQUFFRCxJQUZQO0FBR0UsUUFBQSxHQUFHLEVBQUcsUUFBTyxLQUFLckQsS0FBTCxDQUFXb0MsSUFBWCxDQUFnQm1CLEVBQUcsRUFIbEM7QUFJRSxRQUFBLE9BQU8sRUFBRSxLQUFLdkQsS0FBTCxDQUFXaUQ7QUFKdEIsUUFERjtBQVFEOztBQUNELFVBQU1PLE1BQU0sR0FBRyxDQUFDSCxJQUFELEVBQU9JLE1BQVAsQ0FBY04sSUFBZCxDQUFmO0FBQ0Esd0JBQ0U7QUFDRSxNQUFBLFNBQVMsRUFBRyxjQUFhLEtBQUtuRCxLQUFMLENBQVdzRCxTQUFYLElBQXdCLEVBQUcsRUFEdEQ7QUFFRSxNQUFBLE9BQU8sRUFBRSxLQUFLdEQsS0FBTCxDQUFXaUQ7QUFGdEIsT0FJR08sTUFBTSxDQUFDRSxHQUFQLENBQVcsQ0FBQ0MsR0FBRCxFQUFNQyxLQUFOLEtBQWdCO0FBQzFCLDBCQUNFO0FBQ0UsUUFBQSxLQUFLLEVBQUUsS0FBSzVELEtBQUwsQ0FBVzZELEtBRHBCO0FBRUUsUUFBQSxHQUFHLEVBQUVGLEdBRlA7QUFHRSxRQUFBLEdBQUcsRUFBRUMsS0FIUDtBQUlFLFFBQUEsR0FBRyxFQUFHLFFBQU9BLEtBQUssR0FBRyxDQUFFLElBQUcsS0FBSzVELEtBQUwsQ0FBV29DLElBQVgsQ0FBZ0JtQixFQUFHLEVBSi9DO0FBS0UsUUFBQSxTQUFTLEVBQUcsU0FBUUssS0FBSyxHQUFHLENBQUUsT0FBTUosTUFBTSxDQUFDZCxNQUFPO0FBTHBELFFBREY7QUFTRCxLQVZBLENBSkgsQ0FERjtBQWtCRDs7QUFqQ3FDOztBQW9DeEMsTUFBTW9CLFVBQU4sU0FBeUJ6RSxLQUFLLENBQUNDLFNBQS9CLENBQXlDO0FBQ3ZDQyxFQUFBQSxNQUFNLEdBQUc7QUFDUCxVQUFNNkMsSUFBSSxHQUFHLEtBQUtwQyxLQUFMLENBQVdvQyxJQUF4QjtBQUNBLFVBQU1qQyxPQUFPLEdBQUcsS0FBS0gsS0FBTCxDQUFXRyxPQUEzQjs7QUFDQSxRQUFJLENBQUNpQyxJQUFMLEVBQVc7QUFDVCwwQkFBTyx3REFBUDtBQUNEOztBQUNELGFBQVMyQixVQUFULENBQW9CQyxVQUFwQixFQUFnQztBQUM5QixVQUNHQSxVQUFVLEtBQUssSUFBZixJQUF1QixDQUFDNUIsSUFBSSxDQUFDNEIsVUFBOUIsSUFDQTVCLElBQUksQ0FBQzRCLFVBQUwsS0FBb0JBLFVBRnRCLEVBR0U7QUFDQSxlQUFPLFVBQVA7QUFDRDs7QUFDRCxhQUFPLElBQVA7QUFDRDs7QUFDRCx3QkFDRSxtREFDRSxvREFBcUI1QixJQUFJLENBQUNtQixFQUExQixDQURGLGVBRUUsOENBQ0Usb0JBQUMsU0FBRDtBQUFXLE1BQUEsSUFBSSxFQUFFbkIsSUFBakI7QUFBdUIsTUFBQSxTQUFTLEVBQUM7QUFBakMsTUFERixlQUVFO0FBQVEsTUFBQSxJQUFJLEVBQUMsUUFBYjtBQUFzQixNQUFBLE9BQU8sRUFBRSxLQUFLNkIsWUFBTCxDQUFrQnJELElBQWxCLENBQXVCLElBQXZCO0FBQS9CLGVBRkYsZUFLRSwwREFFRTtBQUNFLE1BQUEsSUFBSSxFQUFDLE1BRFA7QUFFRSxNQUFBLFlBQVksRUFBRXdCLElBQUksQ0FBQzhCLEtBRnJCO0FBR0UsTUFBQSxPQUFPLEVBQUUsS0FBS0MsU0FBTCxDQUFldkQsSUFBZixDQUFvQixJQUFwQjtBQUhYLE1BRkYsQ0FMRixlQWFFLDBEQUVFO0FBQ0UsTUFBQSxJQUFJLEVBQUMsTUFEUDtBQUVFLE1BQUEsS0FBSyxFQUFFd0IsSUFBSSxDQUFDZ0MsYUFBTCxJQUFzQixFQUYvQjtBQUdFLE1BQUEsUUFBUSxFQUFFLEtBQUtsQyxTQUFMLENBQWV0QixJQUFmLENBQW9CLElBQXBCO0FBSFosTUFGRixDQWJGLGVBcUJFLDREQUVFO0FBQ0UsTUFBQSxJQUFJLEVBQUMsVUFEUDtBQUVFLE1BQUEsT0FBTyxFQUFFd0IsSUFBSSxDQUFDaUMsU0FGaEI7QUFHRSxNQUFBLFFBQVEsRUFBRSxLQUFLQyxXQUFMLENBQWlCMUQsSUFBakIsQ0FBc0IsSUFBdEI7QUFIWixNQUZGLENBckJGLGVBNkJFO0FBQ0UsTUFBQSxJQUFJLEVBQUMsUUFEUDtBQUVFLE1BQUEsT0FBTyxFQUFFLEtBQUsyRCxVQUFMLENBQWdCM0QsSUFBaEIsQ0FBcUIsSUFBckIsQ0FGWDtBQUdFLE1BQUEsU0FBUyxFQUFFLEtBQUtaLEtBQUwsQ0FBV3dFLE9BQVgsR0FBcUIsR0FBckIsR0FBMkI7QUFIeEMsZ0JBN0JGLGVBb0NFO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZiw2QkFFRTtBQUFPLE1BQUEsU0FBUyxFQUFFVCxVQUFVLENBQUMsSUFBRDtBQUE1QixvQkFDRTtBQUNFLE1BQUEsSUFBSSxFQUFDLE9BRFA7QUFFRSxNQUFBLElBQUksRUFBRyxjQUFhM0IsSUFBSSxDQUFDbUIsRUFBRyxFQUY5QjtBQUdFLE1BQUEsS0FBSyxFQUFDLE1BSFI7QUFJRSxNQUFBLE9BQU8sRUFBRSxDQUFDbkIsSUFBSSxDQUFDNEIsVUFKakI7QUFLRSxNQUFBLFFBQVEsRUFBRSxLQUFLUyxZQUFMLENBQWtCN0QsSUFBbEIsQ0FBdUIsSUFBdkI7QUFMWixNQURGLFNBRkYsZUFZRTtBQUFPLE1BQUEsU0FBUyxFQUFFbUQsVUFBVSxDQUFDLFFBQUQ7QUFBNUIsb0JBQ0U7QUFDRSxNQUFBLElBQUksRUFBQyxPQURQO0FBRUUsTUFBQSxJQUFJLEVBQUcsY0FBYTNCLElBQUksQ0FBQ21CLEVBQUcsRUFGOUI7QUFHRSxNQUFBLEtBQUssRUFBQyxRQUhSO0FBSUUsTUFBQSxPQUFPLEVBQUVuQixJQUFJLENBQUM0QixVQUFMLEtBQW9CLFFBSi9CO0FBS0UsTUFBQSxRQUFRLEVBQUUsS0FBS1MsWUFBTCxDQUFrQjdELElBQWxCLENBQXVCLElBQXZCO0FBTFosTUFERixXQVpGLGVBc0JFO0FBQU8sTUFBQSxTQUFTLEVBQUVtRCxVQUFVLENBQUMsT0FBRDtBQUE1QixvQkFDRTtBQUNFLE1BQUEsSUFBSSxFQUFDLE9BRFA7QUFFRSxNQUFBLElBQUksRUFBRyxjQUFhM0IsSUFBSSxDQUFDbUIsRUFBRyxFQUY5QjtBQUdFLE1BQUEsS0FBSyxFQUFDLE9BSFI7QUFJRSxNQUFBLE9BQU8sRUFBRW5CLElBQUksQ0FBQzRCLFVBQUwsS0FBb0IsT0FKL0I7QUFLRSxNQUFBLFFBQVEsRUFBRSxLQUFLUyxZQUFMLENBQWtCN0QsSUFBbEIsQ0FBdUIsSUFBdkI7QUFMWixNQURGLFVBdEJGLGVBZ0NFO0FBQU8sTUFBQSxTQUFTLEVBQUVtRCxVQUFVLENBQUMsUUFBRDtBQUE1QixvQkFDRTtBQUNFLE1BQUEsSUFBSSxFQUFDLE9BRFA7QUFFRSxNQUFBLElBQUksRUFBRyxjQUFhM0IsSUFBSSxDQUFDbUIsRUFBRyxFQUY5QjtBQUdFLE1BQUEsS0FBSyxFQUFDLFFBSFI7QUFJRSxNQUFBLE9BQU8sRUFBRW5CLElBQUksQ0FBQzRCLFVBQUwsS0FBb0IsUUFKL0I7QUFLRSxNQUFBLFFBQVEsRUFBRSxLQUFLUyxZQUFMLENBQWtCN0QsSUFBbEIsQ0FBdUIsSUFBdkI7QUFMWixNQURGLFdBaENGLENBcENGLENBRkYsZUFrRkUsK0JBbEZGLGVBbUZFLGlDQUNHLENBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxDQUFQLEVBQVUsQ0FBVixFQUFhOEMsR0FBYixDQUFrQmdCLENBQUQsaUJBQ2hCLG9CQUFDLGNBQUQ7QUFDRSxNQUFBLElBQUksRUFBRXRDLElBRFI7QUFFRSxNQUFBLE9BQU8sRUFBRWpDLE9BRlg7QUFHRSxNQUFBLFVBQVUsRUFBRSxLQUFLSCxLQUFMLENBQVdDLFVBSHpCO0FBSUUsTUFBQSxLQUFLLEVBQUV5RSxDQUpUO0FBS0UsTUFBQSxHQUFHLEVBQUVBO0FBTFAsTUFERCxDQURILENBbkZGLENBREY7QUFpR0Q7O0FBRURQLEVBQUFBLFNBQVMsQ0FBQ2pELEtBQUQsRUFBUTtBQUNmLFNBQUtsQixLQUFMLENBQVdvQyxJQUFYLENBQWdCOEIsS0FBaEIsR0FBd0JoRCxLQUFLLENBQUNFLE1BQU4sQ0FBYXVELEtBQXJDO0FBQ0Q7O0FBRUR6QyxFQUFBQSxTQUFTLENBQUNoQixLQUFELEVBQVE7QUFDZixTQUFLbEIsS0FBTCxDQUFXb0MsSUFBWCxDQUFnQmdDLGFBQWhCLEdBQWdDbEQsS0FBSyxDQUFDRSxNQUFOLENBQWF1RCxLQUE3QztBQUNBLFNBQUszRSxLQUFMLENBQVdDLFVBQVgsQ0FBc0JWLE1BQXRCO0FBQ0Q7O0FBRUQrRSxFQUFBQSxXQUFXLENBQUNwRCxLQUFELEVBQVE7QUFDakIsU0FBS2xCLEtBQUwsQ0FBV29DLElBQVgsQ0FBZ0JpQyxTQUFoQixHQUE0Qm5ELEtBQUssQ0FBQ0UsTUFBTixDQUFhd0QsT0FBekM7QUFDQSxTQUFLNUUsS0FBTCxDQUFXQyxVQUFYLENBQXNCVixNQUF0QjtBQUNEOztBQUVEZ0YsRUFBQUEsVUFBVSxHQUFHO0FBQ1gsUUFBSSxDQUFDekIsTUFBTSxDQUFDQyxPQUFQLENBQWUsZ0JBQWYsQ0FBTCxFQUF1QztBQUNyQztBQUNEOztBQUNELFNBQUsvQyxLQUFMLENBQVdvQyxJQUFYLENBQWdCakMsT0FBaEIsQ0FBd0JvRSxVQUF4QixDQUFtQyxLQUFLdkUsS0FBTCxDQUFXb0MsSUFBOUM7QUFDQSxTQUFLcEMsS0FBTCxDQUFXQyxVQUFYLENBQXNCVixNQUF0QjtBQUNEOztBQUVEMEUsRUFBQUEsWUFBWSxHQUFHO0FBQ2IsU0FBS2pFLEtBQUwsQ0FBV0MsVUFBWCxDQUFzQmdFLFlBQXRCLENBQW1DLEtBQUtqRSxLQUFMLENBQVdvQyxJQUE5QztBQUNEOztBQUVEcUMsRUFBQUEsWUFBWSxDQUFDdkQsS0FBRCxFQUFRO0FBQ2xCLFFBQUl5RCxLQUFLLEdBQUd6RCxLQUFLLENBQUNFLE1BQU4sQ0FBYXVELEtBQXpCOztBQUNBLFFBQUlBLEtBQUssS0FBSyxNQUFkLEVBQXNCO0FBQ3BCQSxNQUFBQSxLQUFLLEdBQUcsSUFBUjtBQUNEOztBQUNELFNBQUszRSxLQUFMLENBQVdvQyxJQUFYLENBQWdCNEIsVUFBaEIsR0FBNkJXLEtBQTdCO0FBQ0EsU0FBSzNFLEtBQUwsQ0FBV0MsVUFBWCxDQUFzQlYsTUFBdEI7QUFDRDs7QUFwSnNDOztBQXVKekMsTUFBTXNGLGNBQU4sU0FBNkJ4RixLQUFLLENBQUNDLFNBQW5DLENBQTZDO0FBQzNDQyxFQUFBQSxNQUFNLEdBQUc7QUFDUCxVQUFNNkMsSUFBSSxHQUFHLEtBQUtwQyxLQUFMLENBQVdvQyxJQUF4QjtBQUNBLFVBQU0wQyxLQUFLLEdBQUcsS0FBSzlFLEtBQUwsQ0FBVzhFLEtBQXpCO0FBQ0EsVUFBTUMsSUFBSSxHQUFHM0MsSUFBSSxDQUFDNEMsWUFBTCxDQUFrQixNQUFsQixFQUEwQkYsS0FBMUIsQ0FBYjtBQUNBLFVBQU1HLEtBQUssR0FBRzdDLElBQUksQ0FBQzRDLFlBQUwsQ0FBa0IsT0FBbEIsRUFBMkJGLEtBQTNCLENBQWQ7QUFDQSxVQUFNSSxHQUFHLEdBQUc5QyxJQUFJLENBQUM0QyxZQUFMLENBQWtCLEtBQWxCLEVBQXlCRixLQUF6QixDQUFaO0FBQ0EsVUFBTUssTUFBTSxHQUFHL0MsSUFBSSxDQUFDNEMsWUFBTCxDQUFrQixRQUFsQixFQUE0QkYsS0FBNUIsQ0FBZjs7QUFDQSxhQUFTTSxPQUFULENBQWlCaEQsSUFBakIsRUFBdUI7QUFDckIsMEJBQ0U7QUFDRSxRQUFBLEdBQUcsRUFBRUEsSUFBSSxDQUFDQyxRQURaO0FBRUUsUUFBQSxTQUFTLEVBQUVELElBQUksQ0FBQ2lELE9BQUwsR0FBZSxZQUFmLEdBQThCLElBRjNDO0FBR0UsUUFBQSxHQUFHLEVBQUM7QUFITixRQURGO0FBT0Q7O0FBQ0Qsd0JBQ0U7QUFDRSxNQUFBLEtBQUssRUFBRTtBQUNMM0YsUUFBQUEsT0FBTyxFQUFFLGFBREo7QUFFTEMsUUFBQUEsbUJBQW1CLEVBQUUsZ0JBRmhCO0FBR0xDLFFBQUFBLGdCQUFnQixFQUFFO0FBSGI7QUFEVCxvQkFPRTtBQUNFLE1BQUEsS0FBSyxFQUFFO0FBQ0xRLFFBQUFBLGVBQWUsRUFBRSxDQURaO0FBRUxQLFFBQUFBLFlBQVksRUFBRTtBQUZULE9BRFQ7QUFLRSxNQUFBLFNBQVMsRUFBQyxVQUxaO0FBTUUsTUFBQSxPQUFPLEVBQUUsS0FBS3lGLGFBQUwsQ0FBbUIxRSxJQUFuQixDQUF3QixJQUF4QixFQUE4QixLQUE5QjtBQU5YLE9BUUdzRSxHQUFHLEdBQ0ZFLE9BQU8sQ0FBQ0YsR0FBRCxDQURMLGdCQUdGO0FBQUssTUFBQSxHQUFHLEVBQUMsbUJBQVQ7QUFBNkIsTUFBQSxHQUFHLEVBQUM7QUFBakMsTUFYSixDQVBGLGVBcUJFO0FBQ0UsTUFBQSxLQUFLLEVBQUU7QUFBRTlFLFFBQUFBLGVBQWUsRUFBRSxDQUFuQjtBQUFzQlAsUUFBQUEsWUFBWSxFQUFFO0FBQXBDLE9BRFQ7QUFFRSxNQUFBLFNBQVMsRUFBQyxVQUZaO0FBR0UsTUFBQSxPQUFPLEVBQUUsS0FBS3lGLGFBQUwsQ0FBbUIxRSxJQUFuQixDQUF3QixJQUF4QixFQUE4QixNQUE5QjtBQUhYLE9BS0dtRSxJQUFJLEdBQ0hLLE9BQU8sQ0FBQ0wsSUFBRCxDQURKLGdCQUdIO0FBQUssTUFBQSxHQUFHLEVBQUMscUJBQVQ7QUFBK0IsTUFBQSxHQUFHLEVBQUM7QUFBbkMsTUFSSixDQXJCRixlQWdDRTtBQUFLLE1BQUEsS0FBSyxFQUFFO0FBQUUzRSxRQUFBQSxlQUFlLEVBQUUsQ0FBbkI7QUFBc0JtRixRQUFBQSxhQUFhLEVBQUU7QUFBckM7QUFBWixvQkFDRTtBQUFLLE1BQUEsR0FBRyxFQUFFbkQsSUFBSSxDQUFDQyxRQUFmO0FBQXlCLE1BQUEsR0FBRyxFQUFDO0FBQTdCLE1BREYsQ0FoQ0YsZUFtQ0U7QUFDRSxNQUFBLEtBQUssRUFBRTtBQUFFakMsUUFBQUEsZUFBZSxFQUFFLENBQW5CO0FBQXNCUCxRQUFBQSxZQUFZLEVBQUU7QUFBcEMsT0FEVDtBQUVFLE1BQUEsU0FBUyxFQUFDLFVBRlo7QUFHRSxNQUFBLE9BQU8sRUFBRSxLQUFLeUYsYUFBTCxDQUFtQjFFLElBQW5CLENBQXdCLElBQXhCLEVBQThCLE9BQTlCO0FBSFgsT0FLR3FFLEtBQUssR0FDSkcsT0FBTyxDQUFDSCxLQUFELENBREgsZ0JBR0o7QUFBSyxNQUFBLEdBQUcsRUFBQyxzQkFBVDtBQUFnQyxNQUFBLEdBQUcsRUFBQztBQUFwQyxNQVJKLENBbkNGLGVBOENFO0FBQ0UsTUFBQSxLQUFLLEVBQUU7QUFDTDdFLFFBQUFBLGVBQWUsRUFBRSxDQURaO0FBRUxQLFFBQUFBLFlBQVksRUFBRTtBQUZULE9BRFQ7QUFLRSxNQUFBLFNBQVMsRUFBQyxVQUxaO0FBTUUsTUFBQSxPQUFPLEVBQUUsS0FBS3lGLGFBQUwsQ0FBbUIxRSxJQUFuQixDQUF3QixJQUF4QixFQUE4QixRQUE5QjtBQU5YLE9BUUd1RSxNQUFNLEdBQ0xDLE9BQU8sQ0FBQ0QsTUFBRCxDQURGLGdCQUdMO0FBQUssTUFBQSxHQUFHLEVBQUMscUJBQVQ7QUFBK0IsTUFBQSxHQUFHLEVBQUM7QUFBbkMsTUFYSixDQTlDRixDQURGO0FBK0REOztBQUVERyxFQUFBQSxhQUFhLENBQUNFLFNBQUQsRUFBWTtBQUN2QixTQUFLeEYsS0FBTCxDQUFXQyxVQUFYLENBQXNCcUYsYUFBdEIsQ0FDRSxLQUFLdEYsS0FBTCxDQUFXb0MsSUFEYixFQUVFb0QsU0FGRixFQUdFLEtBQUt4RixLQUFMLENBQVc4RSxLQUhiO0FBS0Q7O0FBeEYwQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIGpzeC1hMTF5L25vLWFjY2Vzcy1rZXkgKi9cbi8qIGVzbGludC1kaXNhYmxlIGpzeC1hMTF5L25vLXN0YXRpYy1lbGVtZW50LWludGVyYWN0aW9ucyAqL1xuLyogZXNsaW50LWRpc2FibGUganN4LWExMXkvY2xpY2stZXZlbnRzLWhhdmUta2V5LWV2ZW50cyAqL1xuLyogZXNsaW50LWRpc2FibGUganN4LWExMXkvbm8tbm9uaW50ZXJhY3RpdmUtZWxlbWVudC1pbnRlcmFjdGlvbnMgKi9cbi8vIE5vdCBjb21wYXRpYmxlIHdpdGggSlNYOlxuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cbi8qIGdsb2JhbHMgUmVhY3QgKi9cblxuZXhwb3J0IGNsYXNzIFZpZXcgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXZcbiAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICBoZWlnaHQ6IFwiMTAwdmhcIixcbiAgICAgICAgICB3aWR0aDogXCIxMDB2d1wiLFxuICAgICAgICAgIGRpc3BsYXk6IFwiZ3JpZFwiLFxuICAgICAgICAgIGdyaWRUZW1wbGF0ZUNvbHVtbnM6IFwiMWZyIDJmclwiLFxuICAgICAgICAgIGdyaWRUZW1wbGF0ZVJvd3M6IFwiMWZyIDFmclwiLFxuICAgICAgICB9fVxuICAgICAgPlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgIGdyaWRSb3dTdGFydDogXCIxXCIsXG4gICAgICAgICAgICBncmlkUm93RW5kOiBcInNwYW4gMlwiLFxuICAgICAgICAgICAgb3ZlcmZsb3c6IFwic2Nyb2xsXCIsXG4gICAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIDxDb250cm9scyBjb250cm9sbGVyPXt0aGlzLnByb3BzLmNvbnRyb2xsZXJ9IC8+XG4gICAgICAgICAgPGRpdiBzdHlsZT17eyBvdmVyZmxvdzogXCJzY3JvbGxcIiB9fT5cbiAgICAgICAgICAgIDxUaWxlTGlzdFxuICAgICAgICAgICAgICBjbGlja1RpbGVTdGF0dXM9e3RoaXMucHJvcHMuY2xpY2tUaWxlU3RhdHVzfVxuICAgICAgICAgICAgICBjb250cm9sbGVyPXt0aGlzLnByb3BzLmNvbnRyb2xsZXJ9XG4gICAgICAgICAgICAgIHRpbGVzZXQ9e3RoaXMucHJvcHMudGlsZXNldH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxkaXZcbiAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgZ3JpZENvbHVtblN0YXJ0OiBcIjJcIixcbiAgICAgICAgICAgIGdyaWRSb3dTdGFydDogXCIxXCIsXG4gICAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIDxUaWxlRWRpdG9yXG4gICAgICAgICAgICB0aWxlPXt0aGlzLnByb3BzLmVkaXRUaWxlMX1cbiAgICAgICAgICAgIHRpbGVzZXQ9e3RoaXMucHJvcHMudGlsZXNldH1cbiAgICAgICAgICAgIGNvbnRyb2xsZXI9e3RoaXMucHJvcHMuY29udHJvbGxlcn1cbiAgICAgICAgICAgIHByaW1hcnk9e3RydWV9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICBncmlkQ29sdW1uU3RhcnQ6IFwiMlwiLFxuICAgICAgICAgICAgZ3JpZFJvd1N0YXJ0OiBcIjJcIixcbiAgICAgICAgICB9fVxuICAgICAgICA+XG4gICAgICAgICAgPFRpbGVFZGl0b3JcbiAgICAgICAgICAgIHRpbGU9e3RoaXMucHJvcHMuZWRpdFRpbGUyfVxuICAgICAgICAgICAgdGlsZXNldD17dGhpcy5wcm9wcy50aWxlc2V0fVxuICAgICAgICAgICAgY29udHJvbGxlcj17dGhpcy5wcm9wcy5jb250cm9sbGVyfVxuICAgICAgICAgICAgcHJpbWFyeT17ZmFsc2V9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbmNsYXNzIENvbnRyb2xzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHsgc2F2aW5nOiBmYWxzZSB9O1xuICB9XG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGZpZWxkc2V0PlxuICAgICAgICA8bGVnZW5kPkNvbnRyb2xzPC9sZWdlbmQ+XG4gICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIG9uQ2xpY2s9e3RoaXMub25TYXZlLmJpbmQodGhpcyl9PlxuICAgICAgICAgIHt0aGlzLnN0YXRlLnNhdmluZyA/IFwiU2F2ZWQhXCIgOiBcIlNhdmVcIn1cbiAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDxsYWJlbD5cbiAgICAgICAgICBJbXBvcnQ6XG4gICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICB0eXBlPVwiZmlsZVwiXG4gICAgICAgICAgICByZWY9e3RoaXMuZmlsZVJlZn1cbiAgICAgICAgICAgIG9uSW5wdXQ9e3RoaXMub25JbnB1dC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgbXVsdGlwbGU9XCIxXCJcbiAgICAgICAgICAvPlxuICAgICAgICA8L2xhYmVsPlxuICAgICAgPC9maWVsZHNldD5cbiAgICApO1xuICB9XG5cbiAgb25TYXZlKCkge1xuICAgIHRoaXMucHJvcHMuY29udHJvbGxlci5zYXZlKCk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IHNhdmluZzogdHJ1ZSB9KTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBzYXZpbmc6IGZhbHNlIH0pO1xuICAgIH0sIDIwMDApO1xuICB9XG5cbiAgb25JbnB1dChldmVudCkge1xuICAgIHRoaXMucHJvcHMuY29udHJvbGxlci5hZGRGaWxlcyhldmVudC50YXJnZXQuZmlsZXMpO1xuICB9XG59XG5cbmNsYXNzIFRpbGVMaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuICAgIGNvbnN0IGdyaWRzID0gdGhpcy5wcm9wcy50aWxlc2V0LnRpbGVHcmlkcygpO1xuICAgIGZvciAoY29uc3QgZ3JpZCBvZiBncmlkcykge1xuICAgICAgcmVzdWx0LnB1c2goXG4gICAgICAgIDxUaWxlR3JpZFxuICAgICAgICAgIHNvdXJjZUZpbGVuYW1lPXtncmlkLnNvdXJjZUZpbGVuYW1lfVxuICAgICAgICAgIGdyaWQ9e2dyaWQuZ3JpZH1cbiAgICAgICAgICBjb250cm9sbGVyPXt0aGlzLnByb3BzLmNvbnRyb2xsZXJ9XG4gICAgICAgICAga2V5PXtncmlkLnNvdXJjZUZpbGVuYW1lfVxuICAgICAgICAvPlxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIHt0aGlzLnByb3BzLmNsaWNrVGlsZVN0YXR1cyA/IChcbiAgICAgICAgICA8ZGl2IG9uQ2xpY2s9e3RoaXMub25DbGlja1N0YXR1cy5iaW5kKHRoaXMpfT5cbiAgICAgICAgICAgIE9uIGNsaWNrOiB7dGhpcy5wcm9wcy5jbGlja1RpbGVTdGF0dXN9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkgOiBudWxsfVxuICAgICAgICA8U3BlY2lhbFRpbGVzXG4gICAgICAgICAgY29udHJvbGxlcj17dGhpcy5wcm9wcy5jb250cm9sbGVyfVxuICAgICAgICAgIHRpbGVzZXQ9e3RoaXMucHJvcHMudGlsZXNldH1cbiAgICAgICAgLz5cbiAgICAgICAge3Jlc3VsdH1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICBvbkNsaWNrU3RhdHVzKCkge1xuICAgIHRoaXMucHJvcHMuY29udHJvbGxlci5lZGl0VGlsZShudWxsKTtcbiAgfVxufVxuXG5jbGFzcyBTcGVjaWFsVGlsZXMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICByZW5kZXIoKSB7XG4gICAgY29uc3QgZXhhbXBsZXMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5wcm9wcy50aWxlc2V0LmV4YW1wbGVzKCkpIHtcbiAgICAgIGV4YW1wbGVzLnB1c2goXG4gICAgICAgIDxsaSBvbkNsaWNrPXsoKSA9PiB0aGlzLnByb3BzLmNvbnRyb2xsZXIuZWRpdEdyb3VwKGUuZ3JvdXAsIGUudGlsZSl9PlxuICAgICAgICAgIDxpbWcgc3JjPXtlLnRpbGUuaW1hZ2VVcmx9IGFsdD1cIlwiIC8+XG4gICAgICAgICAgR3JvdXAge2UuZ3JvdXB9XG4gICAgICAgIDwvbGk+XG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gKFxuICAgICAgPHVsIGNsYXNzTmFtZT1cInNwZWNpYWwtdGlsZXNcIj5cbiAgICAgICAgPGxpIG9uQ2xpY2s9eygpID0+IHRoaXMucHJvcHMuY29udHJvbGxlci5lZGl0RW1wdHlUaWxlKCl9PlxuICAgICAgICAgIDxpbWcgc3JjPVwiL2ltYWdlcy9kZWxldGUucG5nXCIgYWx0PVwiZGVsZXRlXCIgLz5cbiAgICAgICAgICBEZWxldGUgLyBibGFua1xuICAgICAgICA8L2xpPlxuICAgICAgICB7ZXhhbXBsZXN9XG4gICAgICA8L3VsPlxuICAgICk7XG4gIH1cbn1cblxuY2xhc3MgVGlsZUdyaWQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICByZW5kZXIoKSB7XG4gICAgY29uc3QgdGFibGVSb3dzID0gW107XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCB0aGlzLnByb3BzLmdyaWQubGVuZ3RoOyB5KyspIHtcbiAgICAgIGNvbnN0IHJvdyA9IFtdO1xuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0aGlzLnByb3BzLmdyaWRbeV0ubGVuZ3RoOyB4KyspIHtcbiAgICAgICAgY29uc3QgdGlsZSA9IHRoaXMucHJvcHMuZ3JpZFt5XVt4XTtcbiAgICAgICAgaWYgKCF0aWxlKSB7XG4gICAgICAgICAgcm93LnB1c2goPHRkIGtleT17eH0+PC90ZD4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJvdy5wdXNoKFxuICAgICAgICAgICAgPHRkIGtleT17eH0+XG4gICAgICAgICAgICAgIDxUaWxlIHRpbGU9e3RpbGV9IGNvbnRyb2xsZXI9e3RoaXMucHJvcHMuY29udHJvbGxlcn0gLz5cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGFibGVSb3dzLnB1c2goPHRyIGtleT17eX0+e3Jvd308L3RyPik7XG4gICAgfVxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIHt0aGlzLnByb3BzLnNvdXJjZUZpbGVuYW1lfXtcIiBcIn1cbiAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBvbkNsaWNrPXt0aGlzLmRlbGV0ZVNvdXJjZS5iaW5kKHRoaXMpfT5cbiAgICAgICAgICAgIMOXXG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8dGFibGUgY2xhc3NOYW1lPVwidGlsZXNcIj57dGFibGVSb3dzfTwvdGFibGU+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgZGVsZXRlU291cmNlKCkge1xuICAgIGlmICghd2luZG93LmNvbmZpcm0oXCJEZWxldGUgdGhpcyBlbnRpcmUgc2V0IG9mIHRpbGVzP1wiKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnByb3BzLmNvbnRyb2xsZXIuZGVsZXRlU291cmNlKHRoaXMucHJvcHMuc291cmNlRmlsZW5hbWUpO1xuICB9XG59XG5cbmNsYXNzIFRpbGUgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxUaWxlSW1hZ2UgdGlsZT17dGhpcy5wcm9wcy50aWxlfSBvbkNsaWNrPXt0aGlzLm9uQ2xpY2suYmluZCh0aGlzKX0gLz5cbiAgICApO1xuICB9XG5cbiAgb25DbGljaygpIHtcbiAgICB0aGlzLnByb3BzLmNvbnRyb2xsZXIuZWRpdFRpbGUodGhpcy5wcm9wcy50aWxlKTtcbiAgfVxufVxuXG5jbGFzcyBUaWxlSW1hZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICByZW5kZXIoKSB7XG4gICAgY29uc3QgYW5pbSA9IHRoaXMucHJvcHMudGlsZS5hbmltYXRlVXJscztcbiAgICBjb25zdCBtYWluID0gdGhpcy5wcm9wcy50aWxlLmltYWdlVXJsO1xuICAgIGlmICghYW5pbSkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPGltZ1xuICAgICAgICAgIGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9XG4gICAgICAgICAgc3JjPXttYWlufVxuICAgICAgICAgIGFsdD17YFRpbGUgJHt0aGlzLnByb3BzLnRpbGUuaWR9YH1cbiAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2xpY2t9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBpbWFnZXMgPSBbbWFpbl0uY29uY2F0KGFuaW0pO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzTmFtZT17YGFuaW0tdGlsZXMgJHt0aGlzLnByb3BzLmNsYXNzTmFtZSB8fCBcIlwifWB9XG4gICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMub25DbGlja31cbiAgICAgID5cbiAgICAgICAge2ltYWdlcy5tYXAoKHVybCwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGltZ1xuICAgICAgICAgICAgICBzdHlsZT17dGhpcy5wcm9wcy5zdHlsZX1cbiAgICAgICAgICAgICAgc3JjPXt1cmx9XG4gICAgICAgICAgICAgIGtleT17aW5kZXh9XG4gICAgICAgICAgICAgIGFsdD17YFRpbGUgJHtpbmRleCArIDF9ICR7dGhpcy5wcm9wcy50aWxlLmlkfWB9XG4gICAgICAgICAgICAgIGNsYXNzTmFtZT17YGltYWdlLSR7aW5kZXggKyAxfS1vZi0ke2ltYWdlcy5sZW5ndGh9YH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKTtcbiAgICAgICAgfSl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbmNsYXNzIFRpbGVFZGl0b3IgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICByZW5kZXIoKSB7XG4gICAgY29uc3QgdGlsZSA9IHRoaXMucHJvcHMudGlsZTtcbiAgICBjb25zdCB0aWxlc2V0ID0gdGhpcy5wcm9wcy50aWxlc2V0O1xuICAgIGlmICghdGlsZSkge1xuICAgICAgcmV0dXJuIDxkaXY+Q2xpY2sgdG8gZWRpdCBhIHRpbGU8L2Rpdj47XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJhZGlvQ2xhc3Mob2JqZWN0VHlwZSkge1xuICAgICAgaWYgKFxuICAgICAgICAob2JqZWN0VHlwZSA9PT0gbnVsbCAmJiAhdGlsZS5vYmplY3RUeXBlKSB8fFxuICAgICAgICB0aWxlLm9iamVjdFR5cGUgPT09IG9iamVjdFR5cGVcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gXCJzZWxlY3RlZFwiO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiAoXG4gICAgICA8ZmllbGRzZXQ+XG4gICAgICAgIDxsZWdlbmQ+VGlsZSBlZGl0b3Ige3RpbGUuaWR9PC9sZWdlbmQ+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPFRpbGVJbWFnZSB0aWxlPXt0aWxlfSBjbGFzc05hbWU9XCJ4MlwiIC8+XG4gICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgb25DbGljaz17dGhpcy5hZGRBbmltYXRpb24uYmluZCh0aGlzKX0+XG4gICAgICAgICAgICArYW5pbVxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgIFRpdGxlOlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlPXt0aWxlLnRpdGxlfVxuICAgICAgICAgICAgICBvbktleVVwPXt0aGlzLmVkaXRUaXRsZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgIEdyb3VwOlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgdmFsdWU9e3RpbGUuc3BlY2lmaWNHcm91cCB8fCBcIlwifVxuICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5lZGl0R3JvdXAuYmluZCh0aGlzKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICBFeGFtcGxlOlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIHR5cGU9XCJjaGVja2JveFwiXG4gICAgICAgICAgICAgIGNoZWNrZWQ9e3RpbGUuaXNFeGFtcGxlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5lZGl0RXhhbXBsZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgb25DbGljaz17dGhpcy5kZWxldGVUaWxlLmJpbmQodGhpcyl9XG4gICAgICAgICAgICBhY2Nlc3NLZXk9e3RoaXMucHJvcHMucHJpbWFyeSA/IFwiZFwiIDogbnVsbH1cbiAgICAgICAgICA+XG4gICAgICAgICAgICBEZWxldGVcbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJhZGlvc1wiPlxuICAgICAgICAgICAgVHlwZTpcbiAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9e3JhZGlvQ2xhc3MobnVsbCl9PlxuICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICB0eXBlPVwicmFkaW9cIlxuICAgICAgICAgICAgICAgIG5hbWU9e2BvYmplY3RUeXBlLSR7dGlsZS5pZH1gfVxuICAgICAgICAgICAgICAgIHZhbHVlPVwibm9uZVwiXG4gICAgICAgICAgICAgICAgY2hlY2tlZD17IXRpbGUub2JqZWN0VHlwZX1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vblR5cGVDaGFuZ2UuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgTm9uZVxuICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9e3JhZGlvQ2xhc3MoXCJncm91bmRcIil9PlxuICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICB0eXBlPVwicmFkaW9cIlxuICAgICAgICAgICAgICAgIG5hbWU9e2BvYmplY3RUeXBlLSR7dGlsZS5pZH1gfVxuICAgICAgICAgICAgICAgIHZhbHVlPVwiZ3JvdW5kXCJcbiAgICAgICAgICAgICAgICBjaGVja2VkPXt0aWxlLm9iamVjdFR5cGUgPT09IFwiZ3JvdW5kXCJ9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25UeXBlQ2hhbmdlLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIEdyb3VuZFxuICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9e3JhZGlvQ2xhc3MoXCJkZWNvclwiKX0+XG4gICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgIHR5cGU9XCJyYWRpb1wiXG4gICAgICAgICAgICAgICAgbmFtZT17YG9iamVjdFR5cGUtJHt0aWxlLmlkfWB9XG4gICAgICAgICAgICAgICAgdmFsdWU9XCJkZWNvclwiXG4gICAgICAgICAgICAgICAgY2hlY2tlZD17dGlsZS5vYmplY3RUeXBlID09PSBcImRlY29yXCJ9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25UeXBlQ2hhbmdlLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIERlY29yXG4gICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT17cmFkaW9DbGFzcyhcIm9iamVjdFwiKX0+XG4gICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgIHR5cGU9XCJyYWRpb1wiXG4gICAgICAgICAgICAgICAgbmFtZT17YG9iamVjdFR5cGUtJHt0aWxlLmlkfWB9XG4gICAgICAgICAgICAgICAgdmFsdWU9XCJvYmplY3RcIlxuICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3RpbGUub2JqZWN0VHlwZSA9PT0gXCJvYmplY3RcIn1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vblR5cGVDaGFuZ2UuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgT2JqZWN0XG4gICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGhyIC8+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAge1swLCAxLCAyLCAzXS5tYXAoKGkpID0+IChcbiAgICAgICAgICAgIDxUaWxlRGlyZWN0aW9uc1xuICAgICAgICAgICAgICB0aWxlPXt0aWxlfVxuICAgICAgICAgICAgICB0aWxlc2V0PXt0aWxlc2V0fVxuICAgICAgICAgICAgICBjb250cm9sbGVyPXt0aGlzLnByb3BzLmNvbnRyb2xsZXJ9XG4gICAgICAgICAgICAgIGNvdW50PXtpfVxuICAgICAgICAgICAgICBrZXk9e2l9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICkpfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZmllbGRzZXQ+XG4gICAgKTtcbiAgfVxuXG4gIGVkaXRUaXRsZShldmVudCkge1xuICAgIHRoaXMucHJvcHMudGlsZS50aXRsZSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgfVxuXG4gIGVkaXRHcm91cChldmVudCkge1xuICAgIHRoaXMucHJvcHMudGlsZS5zcGVjaWZpY0dyb3VwID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgIHRoaXMucHJvcHMuY29udHJvbGxlci5yZW5kZXIoKTtcbiAgfVxuXG4gIGVkaXRFeGFtcGxlKGV2ZW50KSB7XG4gICAgdGhpcy5wcm9wcy50aWxlLmlzRXhhbXBsZSA9IGV2ZW50LnRhcmdldC5jaGVja2VkO1xuICAgIHRoaXMucHJvcHMuY29udHJvbGxlci5yZW5kZXIoKTtcbiAgfVxuXG4gIGRlbGV0ZVRpbGUoKSB7XG4gICAgaWYgKCF3aW5kb3cuY29uZmlybShcIlJlYWxseSBkZWxldGU/XCIpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMucHJvcHMudGlsZS50aWxlc2V0LmRlbGV0ZVRpbGUodGhpcy5wcm9wcy50aWxlKTtcbiAgICB0aGlzLnByb3BzLmNvbnRyb2xsZXIucmVuZGVyKCk7XG4gIH1cblxuICBhZGRBbmltYXRpb24oKSB7XG4gICAgdGhpcy5wcm9wcy5jb250cm9sbGVyLmFkZEFuaW1hdGlvbih0aGlzLnByb3BzLnRpbGUpO1xuICB9XG5cbiAgb25UeXBlQ2hhbmdlKGV2ZW50KSB7XG4gICAgbGV0IHZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgIGlmICh2YWx1ZSA9PT0gXCJub25lXCIpIHtcbiAgICAgIHZhbHVlID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy5wcm9wcy50aWxlLm9iamVjdFR5cGUgPSB2YWx1ZTtcbiAgICB0aGlzLnByb3BzLmNvbnRyb2xsZXIucmVuZGVyKCk7XG4gIH1cbn1cblxuY2xhc3MgVGlsZURpcmVjdGlvbnMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICByZW5kZXIoKSB7XG4gICAgY29uc3QgdGlsZSA9IHRoaXMucHJvcHMudGlsZTtcbiAgICBjb25zdCBjb3VudCA9IHRoaXMucHJvcHMuY291bnQ7XG4gICAgY29uc3QgbGVmdCA9IHRpbGUuZ2V0RGlyZWN0aW9uKFwibGVmdFwiLCBjb3VudCk7XG4gICAgY29uc3QgcmlnaHQgPSB0aWxlLmdldERpcmVjdGlvbihcInJpZ2h0XCIsIGNvdW50KTtcbiAgICBjb25zdCB0b3AgPSB0aWxlLmdldERpcmVjdGlvbihcInRvcFwiLCBjb3VudCk7XG4gICAgY29uc3QgYm90dG9tID0gdGlsZS5nZXREaXJlY3Rpb24oXCJib3R0b21cIiwgY291bnQpO1xuICAgIGZ1bmN0aW9uIHRpbGVJbWcodGlsZSkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPGltZ1xuICAgICAgICAgIHNyYz17dGlsZS5pbWFnZVVybH1cbiAgICAgICAgICBjbGFzc05hbWU9e3RpbGUuZ3JvdXBJZCA/IFwiZ3JvdXAtdGlsZVwiIDogbnVsbH1cbiAgICAgICAgICBhbHQ9XCJcIlxuICAgICAgICAvPlxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXZcbiAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICBkaXNwbGF5OiBcImlubGluZS1ncmlkXCIsXG4gICAgICAgICAgZ3JpZFRlbXBsYXRlQ29sdW1uczogXCIzMnB4IDMycHggMzJweFwiLFxuICAgICAgICAgIGdyaWRUZW1wbGF0ZVJvd3M6IFwiMzJweCAzMnB4IDMycHhcIixcbiAgICAgICAgfX1cbiAgICAgID5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICBncmlkQ29sdW1uU3RhcnQ6IDIsXG4gICAgICAgICAgICBncmlkUm93U3RhcnQ6IDEsXG4gICAgICAgICAgfX1cbiAgICAgICAgICBjbGFzc05hbWU9XCJ0aWxlLWRpclwiXG4gICAgICAgICAgb25DbGljaz17dGhpcy5lZGl0RGlyZWN0aW9uLmJpbmQodGhpcywgXCJ0b3BcIil9XG4gICAgICAgID5cbiAgICAgICAgICB7dG9wID8gKFxuICAgICAgICAgICAgdGlsZUltZyh0b3ApXG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxpbWcgc3JjPVwiaW1hZ2VzL2Rpci11cC5wbmdcIiBhbHQ9XCJhZGQgdXAgdGlsZVwiIC8+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXZcbiAgICAgICAgICBzdHlsZT17eyBncmlkQ29sdW1uU3RhcnQ6IDEsIGdyaWRSb3dTdGFydDogMiB9fVxuICAgICAgICAgIGNsYXNzTmFtZT1cInRpbGUtZGlyXCJcbiAgICAgICAgICBvbkNsaWNrPXt0aGlzLmVkaXREaXJlY3Rpb24uYmluZCh0aGlzLCBcImxlZnRcIil9XG4gICAgICAgID5cbiAgICAgICAgICB7bGVmdCA/IChcbiAgICAgICAgICAgIHRpbGVJbWcobGVmdClcbiAgICAgICAgICApIDogKFxuICAgICAgICAgICAgPGltZyBzcmM9XCJpbWFnZXMvZGlyLWxlZnQucG5nXCIgYWx0PVwiYWRkIGxlZnQgdGlsZVwiIC8+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgc3R5bGU9e3sgZ3JpZENvbHVtblN0YXJ0OiAyLCBncmlkR3Jvd1N0YXJ0OiAyIH19PlxuICAgICAgICAgIDxpbWcgc3JjPXt0aWxlLmltYWdlVXJsfSBhbHQ9XCJNYWluIHRpbGVcIiAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIHN0eWxlPXt7IGdyaWRDb2x1bW5TdGFydDogMywgZ3JpZFJvd1N0YXJ0OiAyIH19XG4gICAgICAgICAgY2xhc3NOYW1lPVwidGlsZS1kaXJcIlxuICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuZWRpdERpcmVjdGlvbi5iaW5kKHRoaXMsIFwicmlnaHRcIil9XG4gICAgICAgID5cbiAgICAgICAgICB7cmlnaHQgPyAoXG4gICAgICAgICAgICB0aWxlSW1nKHJpZ2h0KVxuICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICA8aW1nIHNyYz1cImltYWdlcy9kaXItcmlnaHQucG5nXCIgYWx0PVwiYWRkIHJpZ2h0IHRpbGVcIiAvPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgIGdyaWRDb2x1bW5TdGFydDogMixcbiAgICAgICAgICAgIGdyaWRSb3dTdGFydDogMyxcbiAgICAgICAgICB9fVxuICAgICAgICAgIGNsYXNzTmFtZT1cInRpbGUtZGlyXCJcbiAgICAgICAgICBvbkNsaWNrPXt0aGlzLmVkaXREaXJlY3Rpb24uYmluZCh0aGlzLCBcImJvdHRvbVwiKX1cbiAgICAgICAgPlxuICAgICAgICAgIHtib3R0b20gPyAoXG4gICAgICAgICAgICB0aWxlSW1nKGJvdHRvbSlcbiAgICAgICAgICApIDogKFxuICAgICAgICAgICAgPGltZyBzcmM9XCJpbWFnZXMvZGlyLWRvd24ucG5nXCIgYWx0PVwiYWRkIGRvd24gdGlsZVwiIC8+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgZWRpdERpcmVjdGlvbihkaXJlY3Rpb24pIHtcbiAgICB0aGlzLnByb3BzLmNvbnRyb2xsZXIuZWRpdERpcmVjdGlvbihcbiAgICAgIHRoaXMucHJvcHMudGlsZSxcbiAgICAgIGRpcmVjdGlvbixcbiAgICAgIHRoaXMucHJvcHMuY291bnRcbiAgICApO1xuICB9XG59XG4iXX0=